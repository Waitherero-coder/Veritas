export async function generateKey():Promise<CryptoKey>{return crypto.subtle.generateKey({name:'AES-GCM',length:256},true,['encrypt','decrypt']);}export async function exportKey(key:CryptoKey):Promise<Uint8Array>{const raw=await crypto.subtle.exportKey('raw',key);return new Uint8Array(raw);}export async function importKey(rawKey:Uint8Array):Promise<CryptoKey>{return crypto.subtle.importKey('raw',rawKey.buffer,'AES-GCM',true,['encrypt','decrypt']);}export async function encryptFile(file:File,key:CryptoKey):Promise<Blob>{const iv=crypto.getRandomValues(new Uint8Array(12));const data=await file.arrayBuffer();const encrypted=await crypto.subtle.encrypt({name:'AES-GCM',iv},key,data);return new Blob([iv,new Uint8Array(encrypted)]);}export async function decryptFile(blob:Blob,key:CryptoKey):Promise<Blob>{const buffer=await blob.arrayBuffer();const iv=buffer.slice(0,12);const encryptedData=buffer.slice(12);const decrypted=await crypto.subtle.decrypt({name:'AES-GCM',iv},key,encryptedData);return new Blob([decrypted]);}
